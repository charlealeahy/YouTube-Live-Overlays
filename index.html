<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"><title>ISS Live Overlay</title>
  <style>
    body { margin: 0; padding: 0; background: transparent; color: white; font-family: Arial; }
    .panel { position: absolute; bottom: 20px; left: 20px; right: 20px;
      background: rgba(0,0,0,0.75); padding: 20px; border-radius: 10px;
      display: flex; justify-content: space-between; align-items: center;
    }
    .info { display: flex; flex-direction: column; }
    .badge { padding: 5px 15px; border-radius: 5px; background: red; font-weight: bold;}
    .offline { background: blue !important; }
  </style>
</head>
<body>
  <div class="panel">
    <div class="info">
      <div id="location" style="font-size:1.5em;">--</div>
      <div id="datetime">--</div>
      <div id="stats">Speed: -- km/s • Elev: -- km</div>
      <div id="coords">--° N, --° E</div>
    </div>
    <div id="livestatus" class="badge">LIVE NOW</div>
    <div id="demographics" style="text-align:right; font-size:0.85em; color:#ccc;">
      Capital: --<br>Population: --<br>Median Age: --<br>Renewables: --%
    </div>
  </div>

  <script>
    async function fetchISS() {
      try {
        const res = await fetch('https://api.wheretheiss.at/v1/satellites/25544');
        const data = await res.json();
        const { latitude, longitude, altitude, velocity } = data;
        const now = new Date().toUTCString();

        document.getElementById('datetime').innerText = now;
        document.getElementById('stats').innerText =
          `Speed: ${(velocity/1000).toFixed(2)} km/s • Elev: ${altitude.toFixed(1)} km`;
        document.getElementById('coords').innerText =
          `${latitude.toFixed(2)}° ${latitude>=0?'N':'S'}, ${longitude.toFixed(2)}° ${longitude>=0?'E':'W'}`;

        // Use simple fallback: lat/lon
        document.getElementById('location').innerText =
          `Lat ${latitude.toFixed(2)}, Lon ${longitude.toFixed(2)}`;

        // Attempt demographic fetch (may fail)
        const country = 'world'; // simplified - full integration may fail via GitHub Pages
        document.getElementById('demographics').innerHTML =
          `Population: --<br>Median Age: --<br>Renewables: --%`;
        
      } catch (e) {
        console.error(e);
        const badge = document.getElementById('livestatus');
        badge.innerText = 'OFFLINE';
        badge.classList.add('offline');
      }
    }

    fetchISS();
    setInterval(fetchISS, 10000);
  </script>
</body>
</html>
